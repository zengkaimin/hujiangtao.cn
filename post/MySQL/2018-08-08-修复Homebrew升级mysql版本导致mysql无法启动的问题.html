<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>修复Homebrew升级mysql版本导致mysql无法启动的问题 | 木先生</title>
    <meta name="description" content="修复Homebrew升级mysql版本导致mysql无法启动的问题">
    <link rel="icon" href="/favicon.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/favicon.png">
  <meta name="msapplication-TileImage" content="/favicon.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.593102d0.css" as="style"><link rel="preload" href="/assets/js/app.9c3b2f40.js" as="script"><link rel="preload" href="/assets/js/34.8a8cce8c.js" as="script"><link rel="prefetch" href="/assets/js/10.db6d2b23.js"><link rel="prefetch" href="/assets/js/11.5eec0cf0.js"><link rel="prefetch" href="/assets/js/12.48cc16ff.js"><link rel="prefetch" href="/assets/js/13.227a98da.js"><link rel="prefetch" href="/assets/js/14.dd432dff.js"><link rel="prefetch" href="/assets/js/15.1937fbfb.js"><link rel="prefetch" href="/assets/js/16.249d8c5c.js"><link rel="prefetch" href="/assets/js/17.f336ed5e.js"><link rel="prefetch" href="/assets/js/18.4a0023fb.js"><link rel="prefetch" href="/assets/js/19.47d9327c.js"><link rel="prefetch" href="/assets/js/2.1faa0878.js"><link rel="prefetch" href="/assets/js/20.c4cd5dc9.js"><link rel="prefetch" href="/assets/js/21.2faac9e3.js"><link rel="prefetch" href="/assets/js/22.6159852d.js"><link rel="prefetch" href="/assets/js/23.4d8c66d7.js"><link rel="prefetch" href="/assets/js/24.ef8ce863.js"><link rel="prefetch" href="/assets/js/25.3cf50925.js"><link rel="prefetch" href="/assets/js/26.67d3b388.js"><link rel="prefetch" href="/assets/js/27.bf825405.js"><link rel="prefetch" href="/assets/js/28.0cb8a491.js"><link rel="prefetch" href="/assets/js/29.99578b0c.js"><link rel="prefetch" href="/assets/js/3.386eea71.js"><link rel="prefetch" href="/assets/js/30.252f5b97.js"><link rel="prefetch" href="/assets/js/31.028178c1.js"><link rel="prefetch" href="/assets/js/32.340c7f35.js"><link rel="prefetch" href="/assets/js/33.1e9d0600.js"><link rel="prefetch" href="/assets/js/35.c94db349.js"><link rel="prefetch" href="/assets/js/36.0b7766b9.js"><link rel="prefetch" href="/assets/js/37.2ff91466.js"><link rel="prefetch" href="/assets/js/38.d9462a48.js"><link rel="prefetch" href="/assets/js/39.52a2f1e0.js"><link rel="prefetch" href="/assets/js/4.77a79f01.js"><link rel="prefetch" href="/assets/js/40.8f3c38e6.js"><link rel="prefetch" href="/assets/js/41.4006441f.js"><link rel="prefetch" href="/assets/js/42.c98081d3.js"><link rel="prefetch" href="/assets/js/43.2fc9c209.js"><link rel="prefetch" href="/assets/js/44.366bd44e.js"><link rel="prefetch" href="/assets/js/45.9baec45e.js"><link rel="prefetch" href="/assets/js/46.5d5e5cb3.js"><link rel="prefetch" href="/assets/js/47.474d0da3.js"><link rel="prefetch" href="/assets/js/48.34232f7f.js"><link rel="prefetch" href="/assets/js/49.269eae44.js"><link rel="prefetch" href="/assets/js/5.b97c8e99.js"><link rel="prefetch" href="/assets/js/50.ddc90ea9.js"><link rel="prefetch" href="/assets/js/51.0d496ebd.js"><link rel="prefetch" href="/assets/js/52.5de4cba2.js"><link rel="prefetch" href="/assets/js/53.291d0b51.js"><link rel="prefetch" href="/assets/js/54.12c976d1.js"><link rel="prefetch" href="/assets/js/55.fcf3c75d.js"><link rel="prefetch" href="/assets/js/6.5fe59aa3.js"><link rel="prefetch" href="/assets/js/7.e4119528.js"><link rel="prefetch" href="/assets/js/8.b36d15bf.js"><link rel="prefetch" href="/assets/js/9.d504111d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.593102d0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">木先生</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/post/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">Contact</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/post/" class="nav-link router-link-active">Blog</a></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="/contact.html" class="nav-link">Contact</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Windows</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>TensorFlow</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Nginx</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>MySQL</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/post/MySQL/2018-08-08-修复Homebrew升级mysql版本导致mysql无法启动的问题.html" class="active sidebar-link">修复Homebrew升级mysql版本导致mysql无法启动的问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/post/MySQL/2018-08-08-修复Homebrew升级mysql版本导致mysql无法启动的问题.html#目录" class="sidebar-link">目录</a></li><li class="sidebar-sub-header"><a href="/post/MySQL/2018-08-08-修复Homebrew升级mysql版本导致mysql无法启动的问题.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/post/MySQL/2018-08-08-修复Homebrew升级mysql版本导致mysql无法启动的问题.html#原因" class="sidebar-link">原因</a></li><li class="sidebar-sub-header"><a href="/post/MySQL/2018-08-08-修复Homebrew升级mysql版本导致mysql无法启动的问题.html#解决方案" class="sidebar-link">解决方案</a></li><li class="sidebar-sub-header"><a href="/post/MySQL/2018-08-08-修复Homebrew升级mysql版本导致mysql无法启动的问题.html#reference" class="sidebar-link">Reference</a></li></ul></li><li><a href="/post/MySQL/2018-07-09-Mysql-使用注意事项.html" class="sidebar-link">MySQL 使用注意事项</a></li><li><a href="/post/MySQL/2018-07-06-多列联合索引的查询问题.html" class="sidebar-link">MySQL 多列联合索引的查询问题</a></li><li><a href="/post/MySQL/2018-04-19-MySQL优化.html" class="sidebar-link">MySQL优化</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Mac</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>API</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="修复homebrew升级mysql版本导致mysql无法启动的问题"><a href="#修复homebrew升级mysql版本导致mysql无法启动的问题" aria-hidden="true" class="header-anchor">#</a> 修复Homebrew升级mysql版本导致mysql无法启动的问题</h1> <h2 id="目录"><a href="#目录" aria-hidden="true" class="header-anchor">#</a> 目录</h2> <p></p><div class="table-of-contents"><ul><li><a href="#目录">目录</a></li><li><a href="#简介">简介</a></li><li><a href="#原因">原因</a></li><li><a href="#解决方案">解决方案</a></li><li><a href="#reference">Reference</a></li></ul></div><p></p> <h2 id="简介"><a href="#简介" aria-hidden="true" class="header-anchor">#</a> 简介</h2> <p>升级其他软件的时候，无意间通过brew升级了所有的软件，
这导致mysql也升级至对应的最新版本<code>mysql@8.0</code>，之前的版本是<code>mysql@5.7</code>，
但是在升级过程中是没有停止mysql服务的，这就导致了一些问题，
今天连接数据库的时候就出现了一些问题，连接不上</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ mysql.server start
Starting MySQL
<span class="token punctuation">..</span> ERROR<span class="token operator">!</span> The server quit without updating PID <span class="token function">file</span> <span class="token punctuation">(</span>/usr/local/var/mysql/wai.local.pid<span class="token punctuation">)</span>.
</code></pre></div><p>搜索了一下，找到了原因和解决方案，如下</p> <h2 id="原因"><a href="#原因" aria-hidden="true" class="header-anchor">#</a> 原因</h2> <blockquote><p>升级之前 mysql 没有正常停止（crash 了），导致mysql数据出错</p></blockquote> <h2 id="解决方案"><a href="#解决方案" aria-hidden="true" class="header-anchor">#</a> 解决方案</h2> <p>既然是因为升级之前没有正常停止mysql，那就在之前的版本重新正常停止对应的服务就好了</p> <blockquote><p>既然说不支持崩溃后的升级，也就是说在升级之前 mysql 没有正常停止（crash 了）。
那我就在上一个（brew upgrade之前的）版本中正常停止它好咯。</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>The main reason is that the older version `mysql@5.7` not stopped
while you upgrade mysql by homebrew, and something inside mysql data was broken.
So you should reinstall older version mysql and stop the mysql services first.
Then upgrade mysql data by mysql_upgrade to fix the broken data.
Then you can uninstall older version or not, and latest version can be used yet.
</code></pre></div><p>具体解决方式如下：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ brew <span class="token function">install</span> mysql@5.7
$ brew services stop mysql <span class="token operator">&amp;&amp;</span> brew services start mysql@5.7
$ brew services stop mysql@5.7 <span class="token operator">&amp;&amp;</span> brew services start mysql
$ mysql_upgrade -u root -p
$ brew uninstall mysql@5.7
</code></pre></div><h2 id="reference"><a href="#reference" aria-hidden="true" class="header-anchor">#</a> Reference</h2> <ul><li><a href="https://blog.notzheng.com/p/brew-mysql-cant-start-solve.html" target="_blank" rel="noopener noreferrer">brew 升级 mysql 8.0 后不能启动的解决方法 - 不郑不郑<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://gist.github.com/nrollr/3f57fc15ded7dddddcc4e82fe137b58e#gistcomment-2672661" target="_blank" rel="noopener noreferrer">fix Install MySQL on macOS Sierra - GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9/20/2018, 5:17:32 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.9c3b2f40.js" defer></script><script src="/assets/js/34.8a8cce8c.js" defer></script>
  </body>
</html>
